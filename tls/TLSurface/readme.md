# Анализ TLS-сервисов и сертификатов в сетях

### Пример для диагностики и анализа конфигураций TLS в локальной сети. 
> Запуск подобных инструментов на VPS может расцениваться как сканер и привести к блокировке, поэтму рекомендуется запускать локально

### 1. Подготовка списка сетей для аудита
Создадим файл `targets.txt` со списком IP-адресов или их диапазоном, например:
```txt
192.168.0.0/24
192.168.1.5
```
В данном случае будет проверяться диапазон IP-адресов с 192.168.0.1 по 192.168.0.255, а также отдельный адрес 192.168.1.5

### 2. Сканирование и фильтрация
Используя `nmap` произведем сканирование (можно также корректировать `-T` и `--host-timeout` для баланса скорости и качества)
```bash
nmap -p 443 -T0 \
    --min-rate 50 --max-retries 2 --host-timeout 10s \
    -n -sS --open --randomize-hosts \
    -iL targets.txt -oG nmap_output.txt

```

Предварительный результат работы `nmap` будет сохранен в файл `nmap_output.txt`. Далее фильтруем живые уникальные хосты, с открытым 443 портом:
```bash
grep -E "Host.*open" nmap_output.txt | awk '{print $2}' | sort | uniq > alive_ips.txt
```

### 3. Проверка TLS-сертификатов
Используем [RealiTLScanner](https://github.com/XTLS/RealiTLScanner)
```bash
./RealiTLScanner -in alive_ips.txt -v -out tls_results.csv
```
